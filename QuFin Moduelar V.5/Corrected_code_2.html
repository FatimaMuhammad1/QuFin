<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuFin - Interactive Economic Heatmap</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.22.10/babel.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://d3js.org/topojson.v3.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3-geo@3"></script>
    <style>
        :root {
            --primary: #05374e;
            --secondary: #848d8c;
            --dark-bg: #0f172a;
            --dark-card: #1e293b;
            --dark-text: #f1f5f9;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }
        
        .dark body {
            background-color: var(--dark-bg);
            color: var(--dark-text);
        }
        
        .hero-gradient {
            background: linear-gradient(135deg, #05374e 0%, #848d8c 100%);
        }
        
        .world-map-container {
            position: relative;
            width: 100%;
            height: 600px;
            background-color: #f8fafc;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .dark .world-map-container {
            background-color: #334155;
        }
        
        .country-tooltip {
            position: absolute;
            padding: 10px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            border-radius: 4px;
            pointer-events: none;
            font-size: 14px;
            z-index: 10;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .map-legend {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: white;
            padding: 10px;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .dark .map-legend {
            background: #334155;
            color: white;
        }
        
        .legend-gradient {
            height: 20px;
            width: 200px;
            background: linear-gradient(to right, #ffeda0, #feb24c, #f03b20);
            margin-bottom: 5px;
        }
        
        .legend-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
        }
        
        .feature-card {
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-slate-900 text-gray-900 dark:text-slate-100">
    <div id="root"></div>

    <script type="text/babel" data-presets="react">
        // Country economic scores data
        const countryScores = {
            "USA": 85, "CAN": 78, "MEX": 65, "BRA": 72, "ARG": 60, "GBR": 82, "FRA": 79, 
            "DEU": 83, "ITA": 70, "ESP": 68, "RUS": 55, "CHN": 80, "IND": 73, "JPN": 81, 
            "AUS": 79, "ZAF": 63, "NGA": 58, "EGY": 57, "SAU": 69, "TUR": 66, "SWE": 84,
            "NOR": 83, "FIN": 82, "DNK": 81, "NLD": 82, "BEL": 79, "CHE": 86, "AUT": 78,
            "POL": 71, "UKR": 53, "KAZ": 62, "IDN": 67, "THA": 68, "VNM": 66, "PHL": 64,
            "MYS": 70, "SGP": 87, "KOR": 80, "PRK": 30, "IRN": 45, "IRQ": 48, "ISR": 75,
            "PSE": 40, "DZA": 56, "LBY": 47, "MAR": 61, "TUN": 59, "GHA": 62, "KEN": 63,
            "ETH": 55, "ZWE": 45, "MOZ": 52, "MDG": 50, "TZA": 58, "COD": 43, "COG": 46,
            "CMR": 57, "AGO": 54, "NAM": 64, "BWA": 68, "ZMB": 56, "MWI": 49, "UGA": 57,
            "SDN": 44, "SSD": 35, "NER": 42, "TCD": 41, "MLI": 45, "SEN": 59, "GMB": 56,
            "GIN": 50, "GNB": 48, "SLE": 49, "LBR": 47, "CIV": 58, "BEN": 56,
            "CAF": 40, "TGO": 53, "BFA": 52, "MRT": 54, "ERI": 43, "DJI": 55,
            "SOM": 35, "BDI": 44, "RWA": 60
        };

        // Feature cards data
        const features = [
            {
                title: 'AI Score Grid',
                description: 'Evaluate investment opportunities across assets with our proprietary scoring system.',
                icon: 'fa-chart-line',
                href: '/pages/aiscoregrid.html'
            },
            {
                title: 'AI Strategies',
                description: 'Access pre-built algorithmic strategies or build your own for optimized trading.',
                icon: 'fa-cogs',
                href: 'pages/aistrategies.html'
            },
            {
                title: 'Global Data',
                description: 'Comprehensive market data and economic indicators from around the world.',
                icon: 'fa-globe',
                href: 'pages/globaldata.html'
            }
        ];

        // World Map Component
        function WorldMap() {
            const mapContainer = React.useRef(null);
            const tooltipRef = React.useRef(null);
            const [selectedCountry, setSelectedCountry] = React.useState(null);

            React.useEffect(() => {
                if (!mapContainer.current) return;

                // Clear any existing SVG
                d3.select(mapContainer.current).selectAll("svg").remove();

                // Set up the map dimensions
                const width = mapContainer.current.clientWidth;
                const height = mapContainer.current.clientHeight;

                // Create SVG container
                const svg = d3.select(mapContainer.current)
                    .append("svg")
                    .attr("width", width)
                    .attr("height", height);

                // Create a tooltip
                const tooltip = d3.select(tooltipRef.current);

                // Create a projection
                const projection = d3.geoNaturalEarth1()
                    .scale(width / 6.5)
                    .translate([width / 2, height / 2]);

                // Create a path generator
                const path = d3.geoPath().projection(projection);

                // Create a color scale
                const colorScale = d3.scaleLinear()
                    .domain([30, 65, 100])
                    .range(["#ffeda0", "#feb24c", "#f03b20"]);

                // Load and draw the world map
                d3.json("https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json").then(function(worldData) {
                    const countries = topojson.feature(worldData, worldData.objects.countries).features;

                    // Draw countries
                    svg.selectAll(".country")
                        .data(countries)
                        .enter().append("path")
                        .attr("class", "country")
                        .attr("d", path)
                        .attr("fill", d => {
                            const countryCode = d.id;
                            const country = worldData.objects.countries.geometries.find(g => g.id === countryCode);
                            const isoCode = country ? country.properties.iso_a3 : null;
                            return isoCode && countryScores[isoCode] !== undefined ? 
                                colorScale(countryScores[isoCode]) : "#ccc";
                        })
                        .style("stroke", "#fff")
                        .style("stroke-width", 0.5)
                        .style("opacity", 0.8)
                        .on("mouseover", function(event, d) {
                            const countryCode = d.id;
                            const country = worldData.objects.countries.geometries.find(g => g.id === countryCode);
                            const isoCode = country ? country.properties.iso_a3 : null;
                            const countryName = country ? country.properties.name : "Unknown";
                            
                            if (isoCode && countryScores[isoCode] !== undefined) {
                                d3.select(this)
                                    .style("opacity", 1)
                                    .style("stroke-width", 2);

                                setSelectedCountry({
                                    name: countryName,
                                    score: countryScores[isoCode],
                                    isoCode: isoCode
                                });

                                // Show tooltip
                                tooltip
                                    .html(`<strong>${countryName}</strong><br/>Economic Score: ${countryScores[isoCode]}`)
                                    .style("left", (event.pageX + 10) + "px")
                                    .style("top", (event.pageY - 28) + "px")
                                    .style("opacity", 1);
                            }
                        })
                        .on("mouseout", function() {
                            d3.select(this)
                                .style("opacity", 0.8)
                                .style("stroke-width", 0.5);
                            
                            setSelectedCountry(null);
                            
                            // Hide tooltip
                            tooltip.style("opacity", 0);
                        })
                        .on("click", function(event, d) {
                            const countryCode = d.id;
                            const country = worldData.objects.countries.geometries.find(g => g.id === countryCode);
                            const isoCode = country ? country.properties.iso_a3 : null;
                            
                            if (isoCode && countryScores[isoCode] !== undefined) {
                                alert(`Country: ${country.properties.name}\nEconomic Score: ${countryScores[isoCode]}\n\nDetailed economic data would be shown here.`);
                            }
                        });

                    // Add legend
                    const legend = svg.append("g")
                        .attr("class", "legend")
                        .attr("transform", `translate(${width - 220}, ${height - 80})`);

                    // Legend gradient
                    const defs = svg.append("defs");
                    const gradient = defs.append("linearGradient")
                        .attr("id", "gradient")
                        .attr("x1", "0%")
                        .attr("y1", "0%")
                        .attr("x2", "100%")
                        .attr("y2", "0%");

                    gradient.append("stop")
                        .attr("offset", "0%")
                        .attr("stop-color", "#ffeda0");

                    gradient.append("stop")
                        .attr("offset", "50%")
                        .attr("stop-color", "#feb24c");

                    gradient.append("stop")
                        .attr("offset", "100%")
                        .attr("stop-color", "#f03b20");

                    legend.append("rect")
                        .attr("width", 200)
                        .attr("height", 20)
                        .style("fill", "url(#gradient)");

                    // Legend labels
                    legend.append("text")
                        .attr("x", 0)
                        .attr("y", 40)
                        .text("30 (Low)")
                        .style("font-size", "12px");

                    legend.append("text")
                        .attr("x", 170)
                        .attr("y", 40)
                        .text("100 (High)")
                        .style("font-size", "12px")
                        .style("text-anchor", "end");
                });

                // Clean up function
                return () => {
                    if (mapContainer.current) {
                        d3.select(mapContainer.current).selectAll("svg").remove();
                    }
                };
            }, []);

            return React.createElement(
                React.Fragment,
                null,
                React.createElement(
                    'div',
                    { 
                        className: 'world-map-container dark:bg-slate-800 rounded-lg shadow-md',
                        ref: mapContainer
                    }
                ),
                React.createElement(
                    'div',
                    {
                        ref: tooltipRef,
                        className: 'country-tooltip'
                    }
                ),
                selectedCountry && React.createElement(
                    'div',
                    { className: 'absolute top-4 left-4 bg-white dark:bg-slate-700 p-3 rounded-lg shadow-md' },
                    React.createElement(
                        'h3',
                        { className: 'font-bold text-lg' },
                        selectedCountry.name
                    ),
                    React.createElement(
                        'p',
                        { className: 'mt-1' },
                        `Economic Score: ${selectedCountry.score}`
                    )
                )
            );
        }

        // Feature Card Component
        function FeatureCard({ feature }) {
            return React.createElement(
                'div',
                { className: 'feature-card bg-white dark:bg-slate-800 rounded-lg p-6 shadow-sm hover:shadow-md transition-all duration-300' },
                React.createElement(
                    'div',
                    { className: `w-12 h-12 rounded-md bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center mb-4` },
                    React.createElement(
                        'i',
                        { className: `fa-solid ${feature.icon} text-primary-500 dark:text-blue-400 text-xl` }
                    )
                ),
                React.createElement('h3', { className: 'text-lg font-semibold mb-2' }, feature.title),
                React.createElement('p', { className: 'text-gray-600 dark:text-slate-400 mb-4' }, feature.description),
                React.createElement(
                    'a', 
                    { 
                        href: feature.href, 
                        className: 'text-primary-500 font-medium flex items-center hover:text-primary-600 transition-colors' 
                    },
                    'Learn More',
                    React.createElement('i', { className: 'fa-solid fa-arrow-right ml-2 text-sm' })
                )
            );
        }

        // Main App Component
        function App() {
            const [darkMode, setDarkMode] = React.useState(false);

            // Initialize dark mode
            React.useEffect(() => {
                const savedTheme = localStorage.getItem('theme');
                const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                
                if (savedTheme === 'dark' || (!savedTheme && systemPrefersDark)) {
                    setDarkMode(true);
                    document.documentElement.classList.add('dark');
                }
            }, []);

            // Toggle dark mode
            const toggleDarkMode = () => {
                setDarkMode(!darkMode);
                document.documentElement.classList.toggle('dark');
                localStorage.setItem('theme', darkMode ? 'light' : 'dark');
            };

            return React.createElement(
                'div',
                { className: `min-h-screen ${darkMode ? 'dark' : ''}` },
                // Header
                React.createElement(
                    'header',
                    { className: 'sticky top-0 z-50 bg-white dark:bg-slate-800 shadow-md py-4' },
                    React.createElement(
                        'div',
                        { className: 'container mx-auto px-4 flex justify-between items-center' },
                        React.createElement(
                            'div',
                            { className: 'flex items-center' },
                            React.createElement(
                                'div',
                                { className: 'flex items-center space-x-2' },
                                React.createElement(
                                    'div',
                                    { className: 'w-10 h-10 rounded-lg bg-primary-500 flex items-center justify-center' },
                                    React.createElement(
                                        'span',
                                        { className: 'text-white font-bold text-xl' },
                                        'Q'
                                    )
                                ),
                                React.createElement(
                                    'span',
                                    { className: 'text-xl font-bold' },
                                    'QuFin'
                                )
                            )
                        ),
                        React.createElement(
                            'button',
                            {
                                onClick: toggleDarkMode,
                                className: 'p-2 rounded-lg bg-gray-100 dark:bg-slate-700 hover:bg-gray-200 dark:hover:bg-slate-600 transition-colors'
                            },
                            darkMode ? 
                                React.createElement('i', { className: 'fa-solid fa-sun text-yellow-400' }) :
                                React.createElement('i', { className: 'fa-solid fa-moon text-blue-400' })
                        )
                    )
                ),
                // Hero Section
                React.createElement(
                    'section',
                    { className: 'hero-gradient text-white py-12' },
                    React.createElement(
                        'div',
                        { className: 'container mx-auto px-4 text-center' },
                        React.createElement(
                            'h1',
                            { className: 'text-4xl md:text-5xl font-bold mb-6' },
                            'Global Economic Intelligence'
                        ),
                        React.createElement(
                            'p',
                            { className: 'text-xl mb-8 max-w-3xl mx-auto' },
                            'Explore economic performance metrics across countries with our interactive heatmap'
                        )
                    )
                ),
                // Main Content
                React.createElement(
                    'main',
                    { className: 'container mx-auto px-4 py-12' },
                    React.createElement(
                        'div',
                        { className: 'grid grid-cols-1 lg:grid-cols-3 gap-8' },
                        // Feature Cards
                        React.createElement(
                            'div',
                            { className: 'lg:col-span-1 space-y-6' },
                            features.map((feature, index) => 
                                React.createElement(FeatureCard, { key: index, feature })
                            )
                        ),
                        // World Map
                        React.createElement(
                            'div',
                            { className: 'lg:col-span-2 relative' },
                            React.createElement(
                                'div',
                                { className: 'bg-white dark:bg-slate-800 rounded-lg shadow-md p-6' },
                                React.createElement(
                                    'h2',
                                    { className: 'text-2xl font-bold mb-4' },
                                    'Global Economic Heatmap'
                                ),
                                React.createElement(
                                    'p',
                                    { className: 'text-gray-600 dark:text-slate-400 mb-6' },
                                    'Hover over countries to view their economic scores. Click for more details.'
                                ),
                                React.createElement(WorldMap)
                            )
                        )
                    )
                ),
                // Footer
                React.createElement(
                    'footer',
                    { className: 'bg-slate-800 text-white py-8 mt-12' },
                    React.createElement(
                        'div',
                        { className: 'container mx-auto px-4 text-center' },
                        React.createElement(
                            'p',
                            null,
                            'Â© 2023 QuFin. All rights reserved.'
                        )
                    )
                )
            );
        }

        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
    </script>
</body>
</html>